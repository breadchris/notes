<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>The Figma Plugin System | breadchris</title>
<meta name="keywords" content="blog/post">
<meta name="description" content="The Figma Plugin System Figma is a design tool that has become the industry standard, similar to how Photoshop became the defacto for photo editing. When everyone uses one tool, it only follows that there will be functionality that different groups of people need that isn&rsquo;t immediately supported. To bridge the gap in functionality, a plugin system is the go-to solution for letting people extend a system how they see fit.">
<meta name="author" content="breadchris">
<link rel="canonical" href="https://breadchris.com/blog/the-figma-plugin-system/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.7d0dbc7bebc97247baddbf44f81f3261912c9f64c3f03500922375b9988f4ea9.css" integrity="sha256-fQ28e&#43;vJcke63b9E&#43;B8yYZEsn2TD8DUAkiN1uZiPTqk=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js" integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG&#43;9vmJ0cTS&#43;ovo0FeA="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://breadchris.com/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://breadchris.com/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://breadchris.com/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://breadchris.com/apple-touch-icon.png">
<link rel="mask-icon" href="https://breadchris.com/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><script defer data-domain="breadchris.com" src="https://plausible.io/js/script.js"></script><meta property="og:title" content="The Figma Plugin System" />
<meta property="og:description" content="The Figma Plugin System Figma is a design tool that has become the industry standard, similar to how Photoshop became the defacto for photo editing. When everyone uses one tool, it only follows that there will be functionality that different groups of people need that isn&rsquo;t immediately supported. To bridge the gap in functionality, a plugin system is the go-to solution for letting people extend a system how they see fit." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://breadchris.com/blog/the-figma-plugin-system/" /><meta property="article:section" content="blog" />
<meta property="article:published_time" content="2024-07-12T00:00:00+00:00" />
<meta property="article:modified_time" content="2024-07-12T00:00:00+00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="The Figma Plugin System"/>
<meta name="twitter:description" content="The Figma Plugin System Figma is a design tool that has become the industry standard, similar to how Photoshop became the defacto for photo editing. When everyone uses one tool, it only follows that there will be functionality that different groups of people need that isn&rsquo;t immediately supported. To bridge the gap in functionality, a plugin system is the go-to solution for letting people extend a system how they see fit."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Blogs",
      "item": "https://breadchris.com/blog/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "The Figma Plugin System",
      "item": "https://breadchris.com/blog/the-figma-plugin-system/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "The Figma Plugin System",
  "name": "The Figma Plugin System",
  "description": "The Figma Plugin System Figma is a design tool that has become the industry standard, similar to how Photoshop became the defacto for photo editing. When everyone uses one tool, it only follows that there will be functionality that different groups of people need that isn\u0026rsquo;t immediately supported. To bridge the gap in functionality, a plugin system is the go-to solution for letting people extend a system how they see fit.",
  "keywords": [
    "blog/post"
  ],
  "articleBody": "The Figma Plugin System Figma is a design tool that has become the industry standard, similar to how Photoshop became the defacto for photo editing. When everyone uses one tool, it only follows that there will be functionality that different groups of people need that isn’t immediately supported. To bridge the gap in functionality, a plugin system is the go-to solution for letting people extend a system how they see fit. Figma has a great set of blog posts on how they implemented their plugin system that is certainly worth reading, not just if you intend to build your own but also if you want to see how to reason about building a feature from first principles.\nHow to build a plugin system on the web and also sleep well at night\nAn update on plugin security\nThe posts are great at discussing the technical details, but there are a number of different technologies being discussed that can be confusing to conceptualize. This is a great opportunity to explain some security concepts visually with sketches!\nThe Catz Plugin Let’s say a developer wants to build a plugin called “Catz” that inserts a random cat picture into a Figma file. The developer needs to write code that can update the file. Since the Figma app runs in a web browser, the code could just be Javascript, and it runs on figma.com.\nBut what if that code doesn’t do what the developer said? It turns out Catz is written by an evil dog who wants the whole world to pay more attention to good doggos! What if instead of inserting a cute fluff ball, it would mess with our file and change all the images to slobbering dogs, or worse, take over our account?!\nThe first line of defense might be a human reviewing the plugin to make sure it does what it says it does, but a hacker can be clever with hiding what they are doing. To ensure that the code the plugin is running can’t do whatever the hacker wants is important, and to do this we need what is often referred to as a sandbox (or jail).\nA sandbox restricts what is allowed to be accessed by code. In the case of javascript code running on a page, we especially don’t want it to have access to important browser things like document, window, eval, etc., since these would let a hacker read and write anything they want to on the website.\nFortunately, browsers have a built-in sandboxing mechanism for running other people’s code called an iframe. Specifically, one that has the sandbox attribute: ",
  "wordCount" : "798",
  "inLanguage": "en",
  "datePublished": "2024-07-12T00:00:00Z",
  "dateModified": "2024-07-12T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "breadchris"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://breadchris.com/blog/the-figma-plugin-system/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "breadchris",
    "logo": {
      "@type": "ImageObject",
      "url": "https://breadchris.com/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://breadchris.com" accesskey="h" title="breadchris (Alt + H)">breadchris</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://breadchris.com/blog" title="blog">
                    <span>blog</span>
                </a>
            </li>
            <li>
                <a href="https://breadchris.com/resume" title="resume">
                    <span>resume</span>
                </a>
            </li>
            <li>
                <a href="https://breadchris.com/tags/" title="tags">
                    <span>tags</span>
                </a>
            </li>
            <li>
                <a href="https://breadchris.com/talks" title="talks">
                    <span>talks</span>
                </a>
            </li>
            <li>
                <a href="https://breadchris.com/thinkies" title="thinkies">
                    <span>thinkies</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      The Figma Plugin System
    </h1>
    <div class="post-meta"><span title='2024-07-12 00:00:00 +0000 UTC'>July 12, 2024</span>&nbsp;·&nbsp;breadchris

</div>
  </header> 
  <div class="post-content"><h3 id="the-figma-plugin-system">The Figma Plugin System<a hidden class="anchor" aria-hidden="true" href="#the-figma-plugin-system">#</a></h3>
<p>Figma is a design tool that has become the industry standard, similar to how Photoshop became the defacto for photo editing. When everyone uses one tool, it only follows that there will be functionality that different groups of people need that isn&rsquo;t immediately supported. To bridge the gap in functionality, a plugin system is the go-to solution for letting people extend a system how they see fit. Figma has a great set of blog posts on how they implemented their plugin system that is certainly worth reading, not just if you intend to build your own but also if you want to see how to reason about building a feature from first principles.</p>
<ul>
<li>
<p><a href="https://www.figma.com/blog/how-we-built-the-figma-plugin-system/">How to build a plugin system on the web and also sleep well at night</a></p>
</li>
<li>
<p><a href="https://www.figma.com/blog/an-update-on-plugin-security/">An update on plugin security</a></p>
</li>
</ul>
<p>The posts are great at discussing the technical details, but there are a number of different technologies being discussed that can be confusing to conceptualize. This is a great opportunity to explain some security concepts visually with sketches!</p>
<h3 id="the-catz-plugin">The Catz Plugin<a hidden class="anchor" aria-hidden="true" href="#the-catz-plugin">#</a></h3>
<p>Let&rsquo;s say a developer wants to build a plugin called &ldquo;Catz&rdquo; that inserts a random cat picture into a Figma file. The developer needs to write <strong>code</strong> that can update the <strong>file</strong>. Since the Figma app runs in a web browser, the <strong>code</strong> could just be Javascript, and it runs on <strong><a href="http://figma.com">figma.com</a></strong>.</p>
<p><img loading="lazy" src="https://i.imgur.com/WaQ16AM.jpeg" alt=""  />
</p>
<p>But what if that code doesn&rsquo;t do what the developer said? It turns out Catz is written by an evil dog who wants the whole world to pay more attention to good doggos! What if instead of inserting a cute fluff ball, it would mess with our file and change all the images to slobbering dogs, or worse, take over our account?!</p>
<p>The first line of defense might be a human reviewing the plugin to make sure it does what it says it does, but a hacker can be clever with hiding what they are doing. To ensure that the code the plugin is running can&rsquo;t do whatever the hacker wants is important, and to do this we need what is often referred to as a <strong>sandbox</strong> (or <strong>jail</strong>).</p>
<p>A sandbox restricts what is allowed to be accessed by code. In the case of javascript code running on a page, we especially don&rsquo;t want it to have access to <strong>important browser things</strong> like <code>document</code>, <code>window</code>, <code>eval</code>, etc., since these would let a hacker read and write anything they want to on the website.</p>
<p>Fortunately, browsers have a built-in sandboxing mechanism for running other people&rsquo;s code called an <strong>iframe</strong>. Specifically, one that has the <strong>sandbox</strong> attribute: <code>&lt;iframe sandbox=&quot;allow-scripts&quot; src=&quot;dog.com/catz.js&quot;</code> &gt;. The important thing to note here is that the code runs with its origin set to <strong>null</strong> instead of <strong><a href="http://figma.com">figma.com</a></strong>, meaning it is completely isolated from the figma. Unfortunately, there are some gotchas here because the code needs to pass messages between <a href="http://figma.com">figma.com</a> and the isolated code which is slow, and developers found using <code>async/await</code> to be confusing (building plugins should be easy and fun!).</p>
<p><img loading="lazy" src="https://i.imgur.com/uMA93Qf.jpeg" alt=""  />
</p>
<p>The solution used by the end of the initial post was Realm (now <a href="https://github.com/endojs/endo/">Endo</a>). This is a library that moves the code back into the figma.com page but theoretically makes it impossible to do bad things by accessing those important browser things. This approach was fast and seemed to meet all the criteria.</p>
<p>That was until some pretty <a href="https://agoric.com/blog/technology/realms-shim-security-updates">devastating vulnerabilities</a> were found in Realm. With some special code, the Catz plugin could get access to those important browser things and do whatever it wanted on <a href="http://figma.com">figma.com</a> (since it is no longer protected by the iframe sandbox).</p>
<p><img loading="lazy" src="https://i.imgur.com/TONoD0n.jpeg" alt=""  />
</p>
<p>Fortunately, Figma had invested some time in their initial research to consider another approach. What if the code ran in a way with zero concept of those important browser things? There is a cool up-and-coming browser technology called Web Assembly (WASM) which gets its name from assembly that your CPU might understand and run, but it runs in your browser. WASM is just a super simple set of instructions that, when combined together, can run a program of arbitrary complexity (known as Turing Complete). The reason this is cool is that there are different languages that can now compile to WASM and run performantly in the browser, C for example. QuickJS is a project written in C that implements an entire Javascript runtime. To put it together, instead of running the Catz plugin with the Javascript runtime that comes with the browser, you could compile <em>another</em> Javascript runtime to WASM and then run that in the browser. This means that the plugin system now has full control over what the code can or cannot do.</p>
<p><img loading="lazy" src="https://i.imgur.com/98hvmT0.jpeg" alt=""  />
</p>
<p>This was the solution that was ultimately used and I think demonstrates some pretty awesome capabilities of what modern browsers are capable of.</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://breadchris.com/tags/blog/post/">blog/post</a></li>
    </ul>
    <form
            action="https://buttondown.email/api/emails/embed-subscribe/breadchris"
            method="post"
            target="popupwindow"
            onsubmit="window.open('https://buttondown.email/breadchris', 'popupwindow')"
            class="embeddable-buttondown-form"
    >
      <input class="input" type="email" name="email" id="bd-input" placeholder="join the email list" />
      <input class="btn" type="submit" id="bd-submit" value="Subscribe" />
    </form>
  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2024 <a href="https://breadchris.com">breadchris</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
